/*
THIS IS A GENERATED/BUNDLED FILE BY ROLLUP
if you want to view the source visit the plugins github repository
*/

'use strict';

var obsidian = require('obsidian');

/******************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

class EmbedFlattener {
    constructor(app, increaseLevelOfEmbeddedHeadings, removeYAML, convertWikiLinks, convertReferencesForBaseURL, baseURL, pageSeparator, headingLevel) {
        this.app = app;
        this.increaseLevelOfEmbeddedHeadings = increaseLevelOfEmbeddedHeadings;
        this.removeYAML = removeYAML;
        this.convertWikiLinks = convertWikiLinks;
        this.convertReferencesForBaseURL = convertReferencesForBaseURL;
        this.baseURL = baseURL;
        this.pageSeparator = pageSeparator;
        this.headingLevel = headingLevel;
        this.page = 1;
        this.headings = {};
    }
    flatten(file, depth = 0) {
        return __awaiter(this, void 0, void 0, function* () {
            var fileContents = yield this.app.vault.read(file);
            const metadata = this.app.metadataCache.getFileCache(file);
            var replacements = [];
            if (metadata.headings && this.convertReferencesForBaseURL) {
                metadata.headings.forEach((heading) => {
                    if (heading.level + (this.increaseLevelOfEmbeddedHeadings ? depth : 0) == this.headingLevel) {
                        var location = heading.position.start.offset;
                        var useLocation = false;
                        var inBlock = false;
                        while (location > 0) {
                            location -= 1;
                            if (inBlock) {
                                if (fileContents[location] == '[') {
                                    useLocation = true;
                                    break;
                                }
                                else if (fileContents[location] == ']') {
                                    break;
                                }
                            }
                            else if (/\s/.test(fileContents[location])) {
                                continue;
                            }
                            else if (fileContents[location] == ']') {
                                inBlock = true;
                            }
                            else {
                                break;
                            }
                        }
                        replacements.push({
                            start: useLocation ? location : heading.position.start.offset,
                            end: useLocation ? location : heading.position.start.offset,
                            string: `\n${this.pageSeparator}\n`
                        });
                    }
                });
            }
            if (metadata.headings && this.increaseLevelOfEmbeddedHeadings && depth > 0) {
                metadata.headings.forEach((heading) => {
                    if (heading.level < 6) {
                        const hashIndex = fileContents.indexOf("#", heading.position.start.offset);
                        replacements.push({
                            start: hashIndex,
                            end: hashIndex,
                            string: "#".repeat(Math.max(Math.min(heading.level + depth, 6) - heading.level, 0))
                        });
                    }
                });
            }
            if (this.removeYAML && metadata.frontmatter) {
                replacements.push({
                    start: metadata.frontmatter.position.start.offset,
                    end: metadata.frontmatter.position.end.offset,
                    string: ''
                });
            }
            if (metadata.embeds) {
                for (const embed of metadata.embeds) {
                    const linkpath = obsidian.getLinkpath(embed.link);
                    const linkedFile = this.app.metadataCache.getFirstLinkpathDest(linkpath, file.path);
                    if (linkedFile && linkedFile.extension.toLowerCase() == "md") {
                        const flattenedLinkedFileContents = yield this.flatten(linkedFile, Math.min(depth + 1, 6));
                        replacements.push({
                            start: embed.position.start.offset,
                            end: embed.position.end.offset,
                            string: flattenedLinkedFileContents
                        });
                    }
                }
            }
            replacements.sort((a, b) => a.start - b.start);
            replacements.reverse().forEach((replacement) => {
                fileContents = fileContents.substring(0, replacement.start) + replacement.string + fileContents.substring(replacement.end);
            });
            return fileContents.trim();
        });
    }
    extractComplaints(fileContents, delimiter) {
        if (delimiter.length == 0) {
            return fileContents;
        }
        const complaintRegex = new RegExp(`${delimiter}(.*)${delimiter}`, 'g');
        var newFileContents = fileContents;
        var replacements = [];
        var match;
        while ((match = complaintRegex.exec(fileContents)) !== null) {
            replacements.push({
                start: match.index,
                end: match.index + match[0].length,
                string: match[1]
            });
        }
        replacements.sort((a, b) => a.start - b.start);
        replacements.reverse().forEach((replacement) => {
            newFileContents = newFileContents.substring(0, replacement.start) + replacement.string + newFileContents.substring(replacement.end);
        });
        newFileContents = newFileContents.trim();
        if (replacements.length > 0) {
            newFileContents += `\n\n${this.pageSeparator}\n\n`;
            replacements.reverse().forEach((replacement) => {
                newFileContents += `- ${replacement.string}\n`;
            });
        }
        return newFileContents.trim();
    }
    replaceLinks(fileContents) {
        var _a;
        const linkRegex = /\[\[(?:([^#\n\]]+)#)?([^\]\n|]+)(?:\|([^\]\n]+))?\]\]/g;
        var newFileContents = fileContents;
        var replacements = [];
        var match;
        while ((match = linkRegex.exec(fileContents)) !== null) {
            let link = match[2];
            if (this.convertReferencesForBaseURL) {
                let split = fileContents.split('# ' + link + '\n');
                if (split.length < 2) {
                    console.log('Linked section "' + link + '" not found!');
                }
                else if (split.length > 2) {
                    new obsidian.Notice('Linked section "' + link + '" found more than once!');
                    console.log('Linked section "' + link + '" found more than once!');
                }
                else {
                    let page = (split[0].substring(0, split[0].length - 1).match(new RegExp(this.pageSeparator, 'g')) || []).length + 1;
                    let title = (_a = match[3]) !== null && _a !== void 0 ? _a : (match[1] ? `${match[1]} â‡¾ ${link}` : link);
                    replacements.push({
                        start: match.index,
                        end: match.index + match[0].length,
                        string: `[${title}](${this.baseURL}/${page}/#${link.toLowerCase().split(' ').join('-').replace(',', '').replace('\'', '')})`
                    });
                }
            }
            else if (this.convertWikiLinks) {
                replacements.push({
                    start: match.index,
                    end: match.index + match[0].length,
                    string: `[${link}](${encodeURI(`obsidian://open?vault=${this.app.vault.getName()}&file=${link}.md`)})`
                });
            }
        }
        replacements.sort((a, b) => a.start - b.start);
        replacements.reverse().forEach((replacement) => {
            newFileContents = newFileContents.substring(0, replacement.start) + replacement.string + newFileContents.substring(replacement.end);
        });
        return newFileContents.trim();
    }
}

class SettingsModal extends obsidian.Modal {
    constructor(plugin) {
        super(plugin.app);
        this.plugin = plugin;
        this.saveLocation = "Obsidian";
        this.increaseLevelOfEmbeddedHeadings = true;
        this.removeYAML = true;
        this.convertReferencesForBaseURL = false;
    }
    onOpen() {
        let { contentEl } = this;
        const saveLocation = new obsidian.Setting(contentEl);
        saveLocation.setName("Save location");
        saveLocation.addDropdown((dropdown) => {
            dropdown.addOption("Obsidian", "Obsidian");
            dropdown.addOption("Clipboard", "Clipboard");
            dropdown.setValue(this.saveLocation);
            dropdown.onChange((value) => { this.saveLocation = value; });
        });
        const increaseHeaders = new obsidian.Setting(contentEl);
        increaseHeaders.setName("Increase headings of referenced notes");
        increaseHeaders.addToggle((toggle) => {
            toggle.setValue(this.increaseLevelOfEmbeddedHeadings);
            toggle.onChange((value) => { this.increaseLevelOfEmbeddedHeadings = value; });
        });
        const removeYAML = new obsidian.Setting(contentEl);
        removeYAML.setName("Remove YAML");
        removeYAML.addToggle((toggle) => {
            toggle.setValue(this.removeYAML);
            toggle.onChange((value) => { this.removeYAML = value; });
        });
        const baseURLExport = new obsidian.Setting(contentEl);
        baseURLExport.setName("Convert references using baseURL");
        baseURLExport.addToggle((toggle) => {
            toggle.setValue(this.convertReferencesForBaseURL);
            toggle.onChange((value) => { this.convertReferencesForBaseURL = value; });
        });
        const saveButton = new obsidian.Setting(contentEl);
        saveButton.addButton((button) => {
            button.setButtonText("Save");
            button.setCta();
            button.onClick((event) => __awaiter(this, void 0, void 0, function* () {
                var _a;
                const activeFile = this.app.workspace.getActiveFile();
                const metadata = this.app.metadataCache.getFileCache(activeFile);
                if (this.convertReferencesForBaseURL && (!metadata.frontmatter || !metadata.frontmatter['baseURL'])) {
                    new obsidian.Notice('No Base URL Found');
                    this.close();
                    return;
                }
                const embedFlattener = new EmbedFlattener(this.app, this.increaseLevelOfEmbeddedHeadings, this.removeYAML, this.saveLocation != "Obsidian" && !this.convertReferencesForBaseURL, this.convertReferencesForBaseURL, (_a = metadata.frontmatter) === null || _a === void 0 ? void 0 : _a['baseURL'], this.plugin.settings.pageSeparator, parseInt(this.plugin.settings.headingLevel[1]));
                const flattened = yield embedFlattener.flatten(activeFile);
                const flattenedLinked = embedFlattener.replaceLinks(flattened);
                const flattenedLinkedExtracted = embedFlattener.extractComplaints(flattenedLinked, this.plugin.settings.complaintDelimiter);
                switch (this.saveLocation) {
                    case "Obsidian":
                        const newFileParent = this.app.fileManager.getNewFileParent(activeFile.path);
                        var firstHeading;
                        var headings = metadata.headings;
                        if (headings) {
                            firstHeading = headings.find((heading) => heading.level == 1);
                        }
                        var fileName = "Untitled.md";
                        var num = 1;
                        if (firstHeading) {
                            fileName = `${firstHeading.heading}.md`;
                            while (yield this.app.vault.adapter.exists(newFileParent.path + fileName)) {
                                fileName = `${firstHeading.heading} ${num}.md`;
                                num++;
                            }
                        }
                        else {
                            while (yield this.app.vault.adapter.exists(newFileParent.path + fileName)) {
                                fileName = `Untitled ${num}.md`;
                                num++;
                            }
                        }
                        yield this.app.vault.create(newFileParent.path + fileName, flattenedLinkedExtracted);
                        yield this.app.workspace.openLinkText(newFileParent.path + fileName, "");
                        new obsidian.Notice(`Exported to ${fileName}!`);
                        break;
                    case "Clipboard":
                        navigator.clipboard.writeText(flattenedLinkedExtracted);
                        new obsidian.Notice("Exported to Clipboard!");
                        break;
                }
                this.close();
            }));
        });
    }
    onClose() {
        let { contentEl } = this;
        contentEl.empty();
    }
}

const DEFAULT_SETTINGS = {
    pageSeparator: '<!--nextpage-->',
    headingLevel: 'H2',
    complaintDelimiter: ''
};
class ExportPlugin extends obsidian.Plugin {
    onload() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.loadSettings();
            obsidian.addIcon('share-export', '<path d="M38.1609646,27.386905 C40.1107263,27.386905 41.6913204,28.9674991 41.6913204,30.9172608 C41.6913204,32.7973881 40.2216098,34.3342462 38.3683998,34.4416236 L38.1609646,34.4476166 L28.1682857,34.4476166 C23.8526504,34.4476166 20.4999744,37.3040026 20.3498091,40.6480766 L20.3445567,40.8821456 L20.3445567,79.2032472 C20.3445567,82.5687232 23.5991502,85.5015973 27.8687854,85.6331714 L28.1682857,85.6377761 L71.8317143,85.6377761 C76.1473496,85.6377761 79.5000256,82.7813901 79.6501909,79.4373161 L79.6554433,79.2032472 L79.6554433,40.8821456 C79.6554433,37.5230318 76.4126677,34.5936975 72.1601567,34.4528866 L71.8618597,34.4476166 L61.8390354,34.4476166 C59.8892737,34.4476166 58.3086796,32.8670225 58.3086796,30.9172608 C58.3086796,29.0371334 59.7783902,27.5002754 61.6316002,27.392898 L61.8390354,27.386905 L71.8699314,27.386905 C79.8567962,27.4051752 86.5117038,33.1539657 86.7115341,40.5400994 L86.7161549,40.8821456 L86.7161549,79.2032472 C86.7161549,86.6518186 80.1603597,92.5183535 72.2000899,92.6944173 L71.8317143,92.6984878 L28.1682857,92.6984878 C20.1660205,92.6984878 13.4889788,86.9448101 13.2884813,79.5458891 L13.2838451,79.2032472 L13.2838451,40.8821456 C13.2838451,33.4335741 19.8396403,27.5670393 27.7999101,27.3909754 L28.1682857,27.386905 L38.1609646,27.386905 Z" id="Path" fill="currentColor" fill-rule="nonzero"></path><line x1="50.1114536" y1="53" x2="50.1114536" y2="10.4081181" id="Line" stroke="currentColor" stroke-width="6" stroke-linecap="round"></line><line x1="40.3995367" y1="20.120035" x2="50.1114536" y2="10.4081181" id="Line" stroke="currentColor" stroke-width="6" stroke-linecap="round"></line><line x1="50.2229073" y1="20.120035" x2="59.9348242" y2="10.4081181" id="Line" stroke="currentColor" stroke-width="6" stroke-linecap="round" transform="translate(54.967412, 15.375530) scale(-1, 1) translate(-54.967412, -15.375530) "></line>');
            obsidian.addIcon('share-macstories', '<path d="M38.1609646,27.386905 C40.1107263,27.386905 41.6913204,28.9674991 41.6913204,30.9172608 C41.6913204,32.7973881 40.2216098,34.3342462 38.3683998,34.4416236 L38.1609646,34.4476166 L28.1682857,34.4476166 C23.8526504,34.4476166 20.4999744,37.3040026 20.3498091,40.6480766 L20.3445567,40.8821456 L20.3445567,79.2032472 C20.3445567,82.5687232 23.5991502,85.5015973 27.8687854,85.6331714 L28.1682857,85.6377761 L71.8317143,85.6377761 C76.1473496,85.6377761 79.5000256,82.7813901 79.6501909,79.4373161 L79.6554433,79.2032472 L79.6554433,40.8821456 C79.6554433,37.5230318 76.4126677,34.5936975 72.1601567,34.4528866 L71.8618597,34.4476166 L61.8390354,34.4476166 C59.8892737,34.4476166 58.3086796,32.8670225 58.3086796,30.9172608 C58.3086796,29.0371334 59.7783902,27.5002754 61.6316002,27.392898 L61.8390354,27.386905 L71.8699314,27.386905 C79.8567962,27.4051752 86.5117038,33.1539657 86.7115341,40.5400994 L86.7161549,40.8821456 L86.7161549,79.2032472 C86.7161549,86.6518186 80.1603597,92.5183535 72.2000899,92.6944173 L71.8317143,92.6984878 L28.1682857,92.6984878 C20.1660205,92.6984878 13.4889788,86.9448101 13.2884813,79.5458891 L13.2838451,79.2032472 L13.2838451,40.8821456 C13.2838451,33.4335741 19.8396403,27.5670393 27.7999101,27.3909754 L28.1682857,27.386905 L38.1609646,27.386905 Z" id="Path" fill="currentColor" fill-rule="nonzero"></path><line x1="50.1114536" y1="32.4893815" x2="50.1114536" y2="10.4081181" id="Line" stroke="currentColor" stroke-width="6" stroke-linecap="round"></line><path d="M62.2385669,38.8605614 L37.7614331,38.8605614 C36.461592,38.8605614 35.4078626,39.9142908 35.4078626,41.2141319 L35.4078626,78.8712608 L35.4142174,79.0506115 C35.5488523,80.935995 37.7928187,81.921374 39.2771846,80.6717584 L49.9988232,71.6445579 L60.7228154,80.6717584 C62.2535678,81.9604244 64.5921374,80.8722262 64.5921374,78.8712608 L64.5921374,41.2141319 C64.5921374,39.9142908 63.538408,38.8605614 62.2385669,38.8605614 Z M59.8849963,43.567638 L59.8849963,73.8133732 L51.5157515,66.7677086 L51.3571443,66.6452288 C50.4906467,66.0328297 49.3086841,66.0736563 48.4842485,66.7677086 L40.1150037,73.8121964 L40.1150037,43.567638 L59.8849963,43.567638 Z" id="Rectangle" fill="currentColor" fill-rule="nonzero"></path><line x1="40.3995367" y1="20.120035" x2="50.1114536" y2="10.4081181" id="Line" stroke="currentColor" stroke-width="6" stroke-linecap="round"></line><line x1="50.2229073" y1="20.120035" x2="59.9348242" y2="10.4081181" id="Line" stroke="currentColor" stroke-width="6" stroke-linecap="round" transform="translate(54.967412, 15.375530) scale(-1, 1) translate(-54.967412, -15.375530) "></line>');
            this.addSettingTab(new ExportPluginSettingTab(this.app, this));
            this.addCommand({
                id: 'export-markdown-with-embeds',
                name: 'Export Markdown with Embeds',
                icon: 'share-export',
                callback: () => {
                    const file = this.app.workspace.getActiveFile();
                    if (file !== null) {
                        new SettingsModal(this).open();
                        return true;
                    }
                    return false;
                }
            });
            if (this.app.isMobile) {
                this.addCommand({
                    id: 'share-markdown-with-embeds',
                    name: 'Share Markdown with Embeds',
                    icon: 'share-export',
                    callback: () => __awaiter(this, void 0, void 0, function* () {
                        const file = this.app.workspace.getActiveFile();
                        if (file !== null) {
                            const embedFlattener = new EmbedFlattener(this.app, true, true, true, false, '', this.settings.pageSeparator, 0);
                            const flattened = yield embedFlattener.flatten(file);
                            const flattenedLinked = embedFlattener.replaceLinks(flattened);
                            const flattenedLinkedExtracted = embedFlattener.extractComplaints(flattenedLinked, this.settings.complaintDelimiter);
                            const share = {
                                text: flattenedLinkedExtracted,
                            };
                            navigator.share(share);
                            return true;
                        }
                        return false;
                    })
                });
                this.addCommand({
                    id: 'share-markdown-with-embeds-baseURL',
                    name: 'Share Markdown with Embeds with baseURL',
                    icon: 'share-macstories',
                    callback: () => __awaiter(this, void 0, void 0, function* () {
                        var _a;
                        const file = this.app.workspace.getActiveFile();
                        if (file !== null) {
                            const metadata = this.app.metadataCache.getFileCache(file);
                            if ((_a = metadata.frontmatter) === null || _a === void 0 ? void 0 : _a['baseURL']) {
                                const embedFlattener = new EmbedFlattener(this.app, true, true, false, true, metadata.frontmatter['baseURL'], this.settings.pageSeparator, parseInt(this.settings.headingLevel[1]));
                                const flattened = yield embedFlattener.flatten(file);
                                const flattenedLinked = embedFlattener.replaceLinks(flattened);
                                const flattenedLinkedExtracted = embedFlattener.extractComplaints(flattenedLinked, this.settings.complaintDelimiter);
                                const share = {
                                    text: flattenedLinkedExtracted,
                                };
                                navigator.share(share);
                                return true;
                            }
                            else {
                                new obsidian.Notice('No baseURL specified.');
                                return false;
                            }
                        }
                        return false;
                    })
                });
            }
        });
    }
    loadSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
        });
    }
    saveSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.saveData(this.settings);
        });
    }
}
class ExportPluginSettingTab extends obsidian.PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this.plugin = plugin;
    }
    display() {
        let { containerEl } = this;
        containerEl.empty();
        containerEl.createEl('h2', { text: 'Settings for the Export Markdown with Embeds plugin.' });
        new obsidian.Setting(containerEl)
            .setName('Page separator')
            .setDesc('The text to insert between pages when exporting with baseURL.')
            .addText(text => text
            .setPlaceholder('e.x. <!--nextpage-->')
            .setValue(this.plugin.settings.pageSeparator)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.pageSeparator = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('New page heading level')
            .setDesc('The heading level that marks the start of a new page.')
            .addDropdown(dropdown => dropdown
            .addOption('H1', 'H1')
            .addOption('H2', 'H2')
            .addOption('H3', 'H3')
            .addOption('H4', 'H4')
            .addOption('H5', 'H5')
            .addOption('H6', 'H6')
            .setValue(this.plugin.settings.headingLevel)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.headingLevel = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Highlight delimiter')
            .setDesc('Sentences surrounded by the highlight delimiter will be copied to a list at the bottom of the compiled document, and the delimiters will be removed.')
            .addText(text => text
            .setPlaceholder('e.x. :::')
            .setValue(this.plugin.settings.complaintDelimiter)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.complaintDelimiter = value;
            yield this.plugin.saveSettings();
        })));
    }
}

module.exports = ExportPlugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsInNyYy9FbWJlZEZsYXR0ZW5lci50cyIsInNyYy9TZXR0aW5nc01vZGFsLnRzIiwic3JjL21haW4udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cclxuXHJcblBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueVxyXG5wdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXHJcblxyXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIXHJcblJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxyXG5BTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsXHJcbklORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTVxyXG5MT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxyXG5PVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SXHJcblBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxyXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMCAmJiBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwocywgcFtpXSkpXHJcbiAgICAgICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgICAgICB9XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fY3JlYXRlQmluZGluZyA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcclxuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XHJcbiAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XHJcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xyXG4gICAgICAgIGRlc2MgPSB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH07XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIGRlc2MpO1xyXG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xyXG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcclxuICAgIG9bazJdID0gbVtrXTtcclxufSk7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIG8pIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobywgcCkpIF9fY3JlYXRlQmluZGluZyhvLCBtLCBwKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuLyoqIEBkZXByZWNhdGVkICovXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuLyoqIEBkZXByZWNhdGVkICovXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5cygpIHtcclxuICAgIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xyXG4gICAgZm9yICh2YXIgciA9IEFycmF5KHMpLCBrID0gMCwgaSA9IDA7IGkgPCBpbDsgaSsrKVxyXG4gICAgICAgIGZvciAodmFyIGEgPSBhcmd1bWVudHNbaV0sIGogPSAwLCBqbCA9IGEubGVuZ3RoOyBqIDwgamw7IGorKywgaysrKVxyXG4gICAgICAgICAgICByW2tdID0gYVtqXTtcclxuICAgIHJldHVybiByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWRBcnJheSh0bywgZnJvbSwgcGFjaykge1xyXG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XHJcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XHJcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2IH0pO1xyXG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcclxuICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKGsgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGspO1xyXG4gICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZEdldChyZWNlaXZlciwgc3RhdGUsIGtpbmQsIGYpIHtcclxuICAgIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIGdldHRlclwiKTtcclxuICAgIGlmICh0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyICE9PSBzdGF0ZSB8fCAhZiA6ICFzdGF0ZS5oYXMocmVjZWl2ZXIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHJlYWQgcHJpdmF0ZSBtZW1iZXIgZnJvbSBhbiBvYmplY3Qgd2hvc2UgY2xhc3MgZGlkIG5vdCBkZWNsYXJlIGl0XCIpO1xyXG4gICAgcmV0dXJuIGtpbmQgPT09IFwibVwiID8gZiA6IGtpbmQgPT09IFwiYVwiID8gZi5jYWxsKHJlY2VpdmVyKSA6IGYgPyBmLnZhbHVlIDogc3RhdGUuZ2V0KHJlY2VpdmVyKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRTZXQocmVjZWl2ZXIsIHN0YXRlLCB2YWx1ZSwga2luZCwgZikge1xyXG4gICAgaWYgKGtpbmQgPT09IFwibVwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBtZXRob2QgaXMgbm90IHdyaXRhYmxlXCIpO1xyXG4gICAgaWYgKGtpbmQgPT09IFwiYVwiICYmICFmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBhY2Nlc3NvciB3YXMgZGVmaW5lZCB3aXRob3V0IGEgc2V0dGVyXCIpO1xyXG4gICAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3Qgd3JpdGUgcHJpdmF0ZSBtZW1iZXIgdG8gYW4gb2JqZWN0IHdob3NlIGNsYXNzIGRpZCBub3QgZGVjbGFyZSBpdFwiKTtcclxuICAgIHJldHVybiAoa2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIsIHZhbHVlKSA6IGYgPyBmLnZhbHVlID0gdmFsdWUgOiBzdGF0ZS5zZXQocmVjZWl2ZXIsIHZhbHVlKSksIHZhbHVlO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZEluKHN0YXRlLCByZWNlaXZlcikge1xyXG4gICAgaWYgKHJlY2VpdmVyID09PSBudWxsIHx8ICh0eXBlb2YgcmVjZWl2ZXIgIT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIHJlY2VpdmVyICE9PSBcImZ1bmN0aW9uXCIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHVzZSAnaW4nIG9wZXJhdG9yIG9uIG5vbi1vYmplY3RcIik7XHJcbiAgICByZXR1cm4gdHlwZW9mIHN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyByZWNlaXZlciA9PT0gc3RhdGUgOiBzdGF0ZS5oYXMocmVjZWl2ZXIpO1xyXG59XHJcbiIsImltcG9ydCB7IEFwcCwgRW1iZWRDYWNoZSwgZ2V0TGlua3BhdGgsIExpbmtDYWNoZSwgTm90aWNlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiXG5cbmludGVyZmFjZSBSZXBsYWNlbWVudCB7XG4gICAgc3RhcnQ6IG51bWJlclxuICAgIGVuZDogbnVtYmVyXG4gICAgc3RyaW5nOiBzdHJpbmdcbn1cblxuZXhwb3J0IGNsYXNzIEVtYmVkRmxhdHRlbmVyIHtcbiAgICBwYWdlOiBudW1iZXIgPSAxXG4gICAgaGVhZGluZ3M6IHsgW2tleTogc3RyaW5nXTogbnVtYmVyIH0gPSB7fVxuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHJlYWRvbmx5IGFwcDogQXBwLCBcbiAgICAgICAgcmVhZG9ubHkgaW5jcmVhc2VMZXZlbE9mRW1iZWRkZWRIZWFkaW5nczogQm9vbGVhbixcbiAgICAgICAgcmVhZG9ubHkgcmVtb3ZlWUFNTDogYm9vbGVhbixcbiAgICAgICAgcmVhZG9ubHkgY29udmVydFdpa2lMaW5rczogQm9vbGVhbixcbiAgICAgICAgcmVhZG9ubHkgY29udmVydFJlZmVyZW5jZXNGb3JCYXNlVVJMOiBCb29sZWFuLFxuICAgICAgICByZWFkb25seSBiYXNlVVJMOiBzdHJpbmcsXG4gICAgICAgIHJlYWRvbmx5IHBhZ2VTZXBhcmF0b3I6IHN0cmluZyxcbiAgICAgICAgcmVhZG9ubHkgaGVhZGluZ0xldmVsOiBudW1iZXJcbiAgICApIHt9XG5cbiAgICBhc3luYyBmbGF0dGVuKGZpbGU6IFRGaWxlLCBkZXB0aDogbnVtYmVyID0gMCk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIHZhciBmaWxlQ29udGVudHMgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpXG4gICAgICAgIGNvbnN0IG1ldGFkYXRhID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSlcblxuICAgICAgICB2YXIgcmVwbGFjZW1lbnRzOiBSZXBsYWNlbWVudFtdID0gW11cblxuICAgICAgICBpZiAobWV0YWRhdGEuaGVhZGluZ3MgJiYgdGhpcy5jb252ZXJ0UmVmZXJlbmNlc0ZvckJhc2VVUkwpIHtcbiAgICAgICAgICAgIG1ldGFkYXRhLmhlYWRpbmdzLmZvckVhY2goKGhlYWRpbmcpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoaGVhZGluZy5sZXZlbCArICh0aGlzLmluY3JlYXNlTGV2ZWxPZkVtYmVkZGVkSGVhZGluZ3MgPyBkZXB0aCA6IDApID09IHRoaXMuaGVhZGluZ0xldmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IGhlYWRpbmcucG9zaXRpb24uc3RhcnQub2Zmc2V0XG4gICAgICAgICAgICAgICAgICAgIHZhciB1c2VMb2NhdGlvbiA9IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbkJsb2NrID0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGxvY2F0aW9uID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24gLT0gMVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluQmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZUNvbnRlbnRzW2xvY2F0aW9uXSA9PSAnWycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlTG9jYXRpb24gPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlQ29udGVudHNbbG9jYXRpb25dID09ICddJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoL1xccy8udGVzdChmaWxlQ29udGVudHNbbG9jYXRpb25dKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZpbGVDb250ZW50c1tsb2NhdGlvbl0gPT0gJ10nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5CbG9jayA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiB1c2VMb2NhdGlvbiA/IGxvY2F0aW9uIDogaGVhZGluZy5wb3NpdGlvbi5zdGFydC5vZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IHVzZUxvY2F0aW9uID8gbG9jYXRpb24gOiBoZWFkaW5nLnBvc2l0aW9uLnN0YXJ0Lm9mZnNldCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZzogYFxcbiR7dGhpcy5wYWdlU2VwYXJhdG9yfVxcbmBcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1ldGFkYXRhLmhlYWRpbmdzICYmIHRoaXMuaW5jcmVhc2VMZXZlbE9mRW1iZWRkZWRIZWFkaW5ncyAmJiBkZXB0aCA+IDApIHtcbiAgICAgICAgICAgIG1ldGFkYXRhLmhlYWRpbmdzLmZvckVhY2goKGhlYWRpbmcpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoaGVhZGluZy5sZXZlbCA8IDYpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaGFzaEluZGV4ID0gZmlsZUNvbnRlbnRzLmluZGV4T2YoXCIjXCIsIGhlYWRpbmcucG9zaXRpb24uc3RhcnQub2Zmc2V0KVxuICAgICAgICAgICAgICAgICAgICByZXBsYWNlbWVudHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogaGFzaEluZGV4LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBoYXNoSW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmc6IFwiI1wiLnJlcGVhdChNYXRoLm1heChNYXRoLm1pbihoZWFkaW5nLmxldmVsICsgZGVwdGgsIDYpIC0gaGVhZGluZy5sZXZlbCwgMCkpXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnJlbW92ZVlBTUwgJiYgbWV0YWRhdGEuZnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgICAgIHJlcGxhY2VtZW50cy5wdXNoKHtcbiAgICAgICAgICAgICAgICBzdGFydDogbWV0YWRhdGEuZnJvbnRtYXR0ZXIucG9zaXRpb24uc3RhcnQub2Zmc2V0LFxuICAgICAgICAgICAgICAgIGVuZDogbWV0YWRhdGEuZnJvbnRtYXR0ZXIucG9zaXRpb24uZW5kLm9mZnNldCxcbiAgICAgICAgICAgICAgICBzdHJpbmc6ICcnXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1ldGFkYXRhLmVtYmVkcykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBlbWJlZCBvZiBtZXRhZGF0YS5lbWJlZHMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5rcGF0aCA9IGdldExpbmtwYXRoKGVtYmVkLmxpbmspXG4gICAgICAgICAgICAgICAgY29uc3QgbGlua2VkRmlsZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QoXG4gICAgICAgICAgICAgICAgICAgIGxpbmtwYXRoLCBcbiAgICAgICAgICAgICAgICAgICAgZmlsZS5wYXRoXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIGlmIChsaW5rZWRGaWxlICYmIGxpbmtlZEZpbGUuZXh0ZW5zaW9uLnRvTG93ZXJDYXNlKCkgPT0gXCJtZFwiKSB7IFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmbGF0dGVuZWRMaW5rZWRGaWxlQ29udGVudHMgPSBhd2FpdCB0aGlzLmZsYXR0ZW4obGlua2VkRmlsZSwgTWF0aC5taW4oZGVwdGggKyAxLCA2KSlcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBlbWJlZC5wb3NpdGlvbi5zdGFydC5vZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IGVtYmVkLnBvc2l0aW9uLmVuZC5vZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmc6IGZsYXR0ZW5lZExpbmtlZEZpbGVDb250ZW50c1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJlcGxhY2VtZW50cy5zb3J0KChhLCBiKSA9PiBhLnN0YXJ0IC0gYi5zdGFydClcbiAgICAgICAgcmVwbGFjZW1lbnRzLnJldmVyc2UoKS5mb3JFYWNoKChyZXBsYWNlbWVudCkgPT4ge1xuICAgICAgICAgICAgZmlsZUNvbnRlbnRzID0gZmlsZUNvbnRlbnRzLnN1YnN0cmluZygwLCByZXBsYWNlbWVudC5zdGFydCkgKyByZXBsYWNlbWVudC5zdHJpbmcgKyBmaWxlQ29udGVudHMuc3Vic3RyaW5nKHJlcGxhY2VtZW50LmVuZClcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIGZpbGVDb250ZW50cy50cmltKClcbiAgICB9XG5cbiAgICBleHRyYWN0Q29tcGxhaW50cyhmaWxlQ29udGVudHM6IHN0cmluZywgZGVsaW1pdGVyOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBpZiAoZGVsaW1pdGVyLmxlbmd0aCA9PSAwKSB7IHJldHVybiBmaWxlQ29udGVudHMgfVxuICAgICAgICBjb25zdCBjb21wbGFpbnRSZWdleCA9IG5ldyBSZWdFeHAoYCR7ZGVsaW1pdGVyfSguKikke2RlbGltaXRlcn1gLCAnZycpXG4gICAgICAgIHZhciBuZXdGaWxlQ29udGVudHMgPSBmaWxlQ29udGVudHNcbiAgICAgICAgdmFyIHJlcGxhY2VtZW50czogUmVwbGFjZW1lbnRbXSA9IFtdXG4gICAgICAgIHZhciBtYXRjaDogUmVnRXhwRXhlY0FycmF5IHwgbnVsbFxuICAgICAgICB3aGlsZSAoKG1hdGNoID0gY29tcGxhaW50UmVnZXguZXhlYyhmaWxlQ29udGVudHMpKSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgcmVwbGFjZW1lbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgIHN0YXJ0OiBtYXRjaC5pbmRleCxcbiAgICAgICAgICAgICAgICBlbmQ6IG1hdGNoLmluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoLFxuICAgICAgICAgICAgICAgIHN0cmluZzogbWF0Y2hbMV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICByZXBsYWNlbWVudHMuc29ydCgoYSwgYikgPT4gYS5zdGFydCAtIGIuc3RhcnQpXG4gICAgICAgIHJlcGxhY2VtZW50cy5yZXZlcnNlKCkuZm9yRWFjaCgocmVwbGFjZW1lbnQpID0+IHtcbiAgICAgICAgICAgIG5ld0ZpbGVDb250ZW50cyA9IG5ld0ZpbGVDb250ZW50cy5zdWJzdHJpbmcoMCwgcmVwbGFjZW1lbnQuc3RhcnQpICsgcmVwbGFjZW1lbnQuc3RyaW5nICsgbmV3RmlsZUNvbnRlbnRzLnN1YnN0cmluZyhyZXBsYWNlbWVudC5lbmQpXG4gICAgICAgIH0pXG4gICAgICAgIG5ld0ZpbGVDb250ZW50cyA9IG5ld0ZpbGVDb250ZW50cy50cmltKClcbiAgICAgICAgaWYgKHJlcGxhY2VtZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBuZXdGaWxlQ29udGVudHMgKz0gYFxcblxcbiR7dGhpcy5wYWdlU2VwYXJhdG9yfVxcblxcbmBcbiAgICAgICAgICAgIHJlcGxhY2VtZW50cy5yZXZlcnNlKCkuZm9yRWFjaCgocmVwbGFjZW1lbnQpID0+IHtcbiAgICAgICAgICAgICAgICBuZXdGaWxlQ29udGVudHMgKz0gYC0gJHtyZXBsYWNlbWVudC5zdHJpbmd9XFxuYFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3RmlsZUNvbnRlbnRzLnRyaW0oKVxuICAgIH1cblxuICAgIHJlcGxhY2VMaW5rcyhmaWxlQ29udGVudHM6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGxpbmtSZWdleCA9IC9cXFtcXFsoPzooW14jXFxuXFxdXSspIyk/KFteXFxdXFxufF0rKSg/OlxcfChbXlxcXVxcbl0rKSk/XFxdXFxdL2dcbiAgICAgICAgdmFyIG5ld0ZpbGVDb250ZW50cyA9IGZpbGVDb250ZW50c1xuICAgICAgICB2YXIgcmVwbGFjZW1lbnRzOiBSZXBsYWNlbWVudFtdID0gW11cblxuICAgICAgICB2YXIgbWF0Y2g6IFJlZ0V4cEV4ZWNBcnJheSB8IG51bGxcbiAgICAgICAgd2hpbGUgKChtYXRjaCA9IGxpbmtSZWdleC5leGVjKGZpbGVDb250ZW50cykpICE9PSBudWxsKSB7XG4gICAgICAgICAgICBsZXQgbGluayA9IG1hdGNoWzJdXG4gICAgICAgICAgICBpZiAodGhpcy5jb252ZXJ0UmVmZXJlbmNlc0ZvckJhc2VVUkwpIHtcbiAgICAgICAgICAgICAgICBsZXQgc3BsaXQgPSBmaWxlQ29udGVudHMuc3BsaXQoJyMgJyArIGxpbmsgKyAnXFxuJylcbiAgICAgICAgICAgICAgICBpZiAoc3BsaXQubGVuZ3RoIDwgMikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTGlua2VkIHNlY3Rpb24gXCInICsgbGluayArICdcIiBub3QgZm91bmQhJylcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNwbGl0Lmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnTGlua2VkIHNlY3Rpb24gXCInICsgbGluayArICdcIiBmb3VuZCBtb3JlIHRoYW4gb25jZSEnKVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTGlua2VkIHNlY3Rpb24gXCInICsgbGluayArICdcIiBmb3VuZCBtb3JlIHRoYW4gb25jZSEnKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwYWdlID0gKHNwbGl0WzBdLnN1YnN0cmluZygwLCBzcGxpdFswXS5sZW5ndGggLSAxKS5tYXRjaChuZXcgUmVnRXhwKHRoaXMucGFnZVNlcGFyYXRvciwgJ2cnKSkgfHwgW10pLmxlbmd0aCArIDFcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRpdGxlID0gbWF0Y2hbM10gPz8gKG1hdGNoWzFdID8gYCR7bWF0Y2hbMV19IOKHviAke2xpbmt9YCA6IGxpbmspXG4gICAgICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBtYXRjaC5pbmRleCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogbWF0Y2guaW5kZXggKyBtYXRjaFswXS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmc6IGBbJHt0aXRsZX1dKCR7dGhpcy5iYXNlVVJMfS8ke3BhZ2V9LyMke2xpbmsudG9Mb3dlckNhc2UoKS5zcGxpdCgnICcpLmpvaW4oJy0nKS5yZXBsYWNlKCcsJywgJycpLnJlcGxhY2UoJ1xcJycsICcnKX0pYFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5jb252ZXJ0V2lraUxpbmtzKSB7XG4gICAgICAgICAgICAgICAgcmVwbGFjZW1lbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBzdGFydDogbWF0Y2guaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IG1hdGNoLmluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nOiBgWyR7bGlua31dKCR7ZW5jb2RlVVJJKGBvYnNpZGlhbjovL29wZW4/dmF1bHQ9JHt0aGlzLmFwcC52YXVsdC5nZXROYW1lKCl9JmZpbGU9JHtsaW5rfS5tZGApfSlgXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJlcGxhY2VtZW50cy5zb3J0KChhLCBiKSA9PiBhLnN0YXJ0IC0gYi5zdGFydClcbiAgICAgICAgcmVwbGFjZW1lbnRzLnJldmVyc2UoKS5mb3JFYWNoKChyZXBsYWNlbWVudCkgPT4ge1xuICAgICAgICAgICAgbmV3RmlsZUNvbnRlbnRzID0gbmV3RmlsZUNvbnRlbnRzLnN1YnN0cmluZygwLCByZXBsYWNlbWVudC5zdGFydCkgKyByZXBsYWNlbWVudC5zdHJpbmcgKyBuZXdGaWxlQ29udGVudHMuc3Vic3RyaW5nKHJlcGxhY2VtZW50LmVuZClcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIG5ld0ZpbGVDb250ZW50cy50cmltKClcbiAgICB9XG59IiwiaW1wb3J0IHsgTW9kYWwsIE5vdGljZSwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiXG5pbXBvcnQgeyBFbWJlZEZsYXR0ZW5lciB9IGZyb20gXCIuL0VtYmVkRmxhdHRlbmVyXCJcbmltcG9ydCBFeHBvcnRQbHVnaW4gZnJvbSBcIi4vbWFpblwiXG5cbmV4cG9ydCBjbGFzcyBTZXR0aW5nc01vZGFsIGV4dGVuZHMgTW9kYWwge1xuXHRzYXZlTG9jYXRpb246IHN0cmluZyA9IFwiT2JzaWRpYW5cIlxuXHRpbmNyZWFzZUxldmVsT2ZFbWJlZGRlZEhlYWRpbmdzOiBib29sZWFuID0gdHJ1ZVxuXHRyZW1vdmVZQU1MOiBib29sZWFuID0gdHJ1ZVxuXHRjb252ZXJ0UmVmZXJlbmNlc0ZvckJhc2VVUkw6IGJvb2xlYW4gPSBmYWxzZVxuXG5cdGNvbnN0cnVjdG9yKHJlYWRvbmx5IHBsdWdpbjogRXhwb3J0UGx1Z2luKSB7IHN1cGVyKHBsdWdpbi5hcHApIH1cblxuXHRvbk9wZW4oKSB7XG5cdFx0bGV0IHtjb250ZW50RWx9ID0gdGhpc1xuXHRcdGNvbnN0IHNhdmVMb2NhdGlvbiA9IG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcblx0XHRzYXZlTG9jYXRpb24uc2V0TmFtZShcIlNhdmUgbG9jYXRpb25cIilcblx0XHRzYXZlTG9jYXRpb24uYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PiB7XG5cdFx0XHRkcm9wZG93bi5hZGRPcHRpb24oXCJPYnNpZGlhblwiLCBcIk9ic2lkaWFuXCIpXG5cdFx0XHRkcm9wZG93bi5hZGRPcHRpb24oXCJDbGlwYm9hcmRcIiwgXCJDbGlwYm9hcmRcIilcblx0XHRcdGRyb3Bkb3duLnNldFZhbHVlKHRoaXMuc2F2ZUxvY2F0aW9uKVxuXHRcdFx0ZHJvcGRvd24ub25DaGFuZ2UoKHZhbHVlKSA9PiB7IHRoaXMuc2F2ZUxvY2F0aW9uID0gdmFsdWUgfSlcblx0XHR9KVxuXHRcdFxuXHRcdGNvbnN0IGluY3JlYXNlSGVhZGVycyA9IG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcblx0XHRpbmNyZWFzZUhlYWRlcnMuc2V0TmFtZShcIkluY3JlYXNlIGhlYWRpbmdzIG9mIHJlZmVyZW5jZWQgbm90ZXNcIilcblx0XHRpbmNyZWFzZUhlYWRlcnMuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHsgXG5cdFx0XHR0b2dnbGUuc2V0VmFsdWUodGhpcy5pbmNyZWFzZUxldmVsT2ZFbWJlZGRlZEhlYWRpbmdzKVxuXHRcdFx0dG9nZ2xlLm9uQ2hhbmdlKCh2YWx1ZSkgPT4geyB0aGlzLmluY3JlYXNlTGV2ZWxPZkVtYmVkZGVkSGVhZGluZ3MgPSB2YWx1ZSB9KVxuXHRcdH0pXG5cblx0XHRjb25zdCByZW1vdmVZQU1MID0gbmV3IFNldHRpbmcoY29udGVudEVsKVxuXHRcdHJlbW92ZVlBTUwuc2V0TmFtZShcIlJlbW92ZSBZQU1MXCIpXG5cdFx0cmVtb3ZlWUFNTC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT4geyBcblx0XHRcdHRvZ2dsZS5zZXRWYWx1ZSh0aGlzLnJlbW92ZVlBTUwpXG5cdFx0XHR0b2dnbGUub25DaGFuZ2UoKHZhbHVlKSA9PiB7IHRoaXMucmVtb3ZlWUFNTCA9IHZhbHVlIH0pXG5cdFx0fSlcblxuXHRcdGNvbnN0IGJhc2VVUkxFeHBvcnQgPSBuZXcgU2V0dGluZyhjb250ZW50RWwpXG5cdFx0YmFzZVVSTEV4cG9ydC5zZXROYW1lKFwiQ29udmVydCByZWZlcmVuY2VzIHVzaW5nIGJhc2VVUkxcIilcblx0XHRiYXNlVVJMRXhwb3J0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7IFxuXHRcdFx0dG9nZ2xlLnNldFZhbHVlKHRoaXMuY29udmVydFJlZmVyZW5jZXNGb3JCYXNlVVJMKVxuXHRcdFx0dG9nZ2xlLm9uQ2hhbmdlKCh2YWx1ZSkgPT4geyB0aGlzLmNvbnZlcnRSZWZlcmVuY2VzRm9yQmFzZVVSTCA9IHZhbHVlIH0pXG5cdFx0fSlcblx0XHRcblx0XHRjb25zdCBzYXZlQnV0dG9uID0gbmV3IFNldHRpbmcoY29udGVudEVsKVxuXHRcdHNhdmVCdXR0b24uYWRkQnV0dG9uKChidXR0b24pID0+IHtcblx0XHRcdGJ1dHRvbi5zZXRCdXR0b25UZXh0KFwiU2F2ZVwiKVxuXHRcdFx0YnV0dG9uLnNldEN0YSgpXG5cdFx0XHRidXR0b24ub25DbGljayhhc3luYyAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKVxuXHRcdFx0XHRjb25zdCBtZXRhZGF0YSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGFjdGl2ZUZpbGUpXG5cblx0XHRcdFx0aWYgKHRoaXMuY29udmVydFJlZmVyZW5jZXNGb3JCYXNlVVJMICYmICghbWV0YWRhdGEuZnJvbnRtYXR0ZXIgfHwgIW1ldGFkYXRhLmZyb250bWF0dGVyWydiYXNlVVJMJ10pKSB7XG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnTm8gQmFzZSBVUkwgRm91bmQnKVxuXHRcdFx0XHRcdHRoaXMuY2xvc2UoKVxuXHRcdFx0XHRcdHJldHVyblxuXHRcdFx0XHR9XG5cdFx0XHRcdGNvbnN0IGVtYmVkRmxhdHRlbmVyID0gbmV3IEVtYmVkRmxhdHRlbmVyKFxuXHRcdFx0XHRcdHRoaXMuYXBwLCBcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbmNyZWFzZUxldmVsT2ZFbWJlZGRlZEhlYWRpbmdzLCBcblx0XHRcdFx0XHR0aGlzLnJlbW92ZVlBTUwsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUxvY2F0aW9uICE9IFwiT2JzaWRpYW5cIiAmJiAhdGhpcy5jb252ZXJ0UmVmZXJlbmNlc0ZvckJhc2VVUkwsXG5cdFx0XHRcdFx0dGhpcy5jb252ZXJ0UmVmZXJlbmNlc0ZvckJhc2VVUkwsXG5cdFx0XHRcdFx0bWV0YWRhdGEuZnJvbnRtYXR0ZXI/LlsnYmFzZVVSTCddLFxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBhZ2VTZXBhcmF0b3IsXG5cdFx0XHRcdFx0cGFyc2VJbnQodGhpcy5wbHVnaW4uc2V0dGluZ3MuaGVhZGluZ0xldmVsWzFdKVxuXHRcdFx0XHQpXG5cdFx0XHRcdGNvbnN0IGZsYXR0ZW5lZCA9IGF3YWl0IGVtYmVkRmxhdHRlbmVyLmZsYXR0ZW4oYWN0aXZlRmlsZSlcblx0XHRcdFx0Y29uc3QgZmxhdHRlbmVkTGlua2VkID0gZW1iZWRGbGF0dGVuZXIucmVwbGFjZUxpbmtzKGZsYXR0ZW5lZClcblx0XHRcdFx0Y29uc3QgZmxhdHRlbmVkTGlua2VkRXh0cmFjdGVkID0gZW1iZWRGbGF0dGVuZXIuZXh0cmFjdENvbXBsYWludHMoZmxhdHRlbmVkTGlua2VkLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb21wbGFpbnREZWxpbWl0ZXIpXG5cdFx0XHRcdHN3aXRjaCAodGhpcy5zYXZlTG9jYXRpb24pIHtcblx0XHRcdFx0XHRjYXNlIFwiT2JzaWRpYW5cIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0ZpbGVQYXJlbnQgPSB0aGlzLmFwcC5maWxlTWFuYWdlci5nZXROZXdGaWxlUGFyZW50KGFjdGl2ZUZpbGUucGF0aClcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuXHRcdFx0XHRcdFx0dmFyIGZpcnN0SGVhZGluZztcblx0XHRcdFx0XHRcdHZhciBoZWFkaW5ncyA9IG1ldGFkYXRhLmhlYWRpbmdzXG5cdFx0XHRcdFx0XHRpZiAoaGVhZGluZ3MpIHtcblx0XHRcdFx0XHRcdFx0Zmlyc3RIZWFkaW5nID0gaGVhZGluZ3MuZmluZCgoaGVhZGluZykgPT4gaGVhZGluZy5sZXZlbCA9PSAxKVxuXHRcdFx0XHRcdFx0fVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZU5hbWUgPSBcIlVudGl0bGVkLm1kXCJcblx0XHRcdFx0XHRcdHZhciBudW0gPSAxXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RIZWFkaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZU5hbWUgPSBgJHtmaXJzdEhlYWRpbmcuaGVhZGluZ30ubWRgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGF3YWl0IHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXIuZXhpc3RzKG5ld0ZpbGVQYXJlbnQucGF0aCArIGZpbGVOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlTmFtZSA9IGAke2ZpcnN0SGVhZGluZy5oZWFkaW5nfSAke251bX0ubWRgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bSsrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci5leGlzdHMobmV3RmlsZVBhcmVudC5wYXRoICsgZmlsZU5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVOYW1lID0gYFVudGl0bGVkICR7bnVtfS5tZGBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtKytcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUobmV3RmlsZVBhcmVudC5wYXRoICsgZmlsZU5hbWUsIGZsYXR0ZW5lZExpbmtlZEV4dHJhY3RlZClcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQobmV3RmlsZVBhcmVudC5wYXRoICsgZmlsZU5hbWUsIFwiXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBFeHBvcnRlZCB0byAke2ZpbGVOYW1lfSFgKVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcblx0XHRcdFx0XHRjYXNlIFwiQ2xpcGJvYXJkXCI6XG5cdFx0XHRcdFx0XHRuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChmbGF0dGVuZWRMaW5rZWRFeHRyYWN0ZWQpXG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlKFwiRXhwb3J0ZWQgdG8gQ2xpcGJvYXJkIVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aGlzLmNsb3NlKClcblx0XHRcdH0pXG5cdFx0fSlcblx0fVxuXG5cdG9uQ2xvc2UoKSB7XG5cdFx0bGV0IHsgY29udGVudEVsIH0gPSB0aGlzXG5cdFx0Y29udGVudEVsLmVtcHR5KClcblx0fVxufSIsImltcG9ydCB7IEFwcCwgYWRkSWNvbiwgTm90aWNlLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbidcclxuaW1wb3J0IHsgRW1iZWRGbGF0dGVuZXIgfSBmcm9tICcuL0VtYmVkRmxhdHRlbmVyJ1xyXG5pbXBvcnQgeyBTZXR0aW5nc01vZGFsIH0gZnJvbSBcIi4vU2V0dGluZ3NNb2RhbFwiXHJcblxyXG5pbnRlcmZhY2UgRXhwb3J0UGx1Z2luU2V0dGluZ3Mge1xyXG5cdHBhZ2VTZXBhcmF0b3I6IHN0cmluZ1xyXG4gIGhlYWRpbmdMZXZlbDogc3RyaW5nXHJcbiAgY29tcGxhaW50RGVsaW1pdGVyOiBzdHJpbmdcclxufVxyXG5cclxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogRXhwb3J0UGx1Z2luU2V0dGluZ3MgPSB7XHJcblx0cGFnZVNlcGFyYXRvcjogJzwhLS1uZXh0cGFnZS0tPicsXHJcbiAgaGVhZGluZ0xldmVsOiAnSDInLFxyXG4gIGNvbXBsYWludERlbGltaXRlcjogJydcclxufVxyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEV4cG9ydFBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcbiAgc2V0dGluZ3M6IEV4cG9ydFBsdWdpblNldHRpbmdzXHJcblxyXG5cdGFzeW5jIG9ubG9hZCgpIHtcclxuICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKClcclxuXHJcbiAgICBhZGRJY29uKCdzaGFyZS1leHBvcnQnLCAnPHBhdGggZD1cIk0zOC4xNjA5NjQ2LDI3LjM4NjkwNSBDNDAuMTEwNzI2MywyNy4zODY5MDUgNDEuNjkxMzIwNCwyOC45Njc0OTkxIDQxLjY5MTMyMDQsMzAuOTE3MjYwOCBDNDEuNjkxMzIwNCwzMi43OTczODgxIDQwLjIyMTYwOTgsMzQuMzM0MjQ2MiAzOC4zNjgzOTk4LDM0LjQ0MTYyMzYgTDM4LjE2MDk2NDYsMzQuNDQ3NjE2NiBMMjguMTY4Mjg1NywzNC40NDc2MTY2IEMyMy44NTI2NTA0LDM0LjQ0NzYxNjYgMjAuNDk5OTc0NCwzNy4zMDQwMDI2IDIwLjM0OTgwOTEsNDAuNjQ4MDc2NiBMMjAuMzQ0NTU2Nyw0MC44ODIxNDU2IEwyMC4zNDQ1NTY3LDc5LjIwMzI0NzIgQzIwLjM0NDU1NjcsODIuNTY4NzIzMiAyMy41OTkxNTAyLDg1LjUwMTU5NzMgMjcuODY4Nzg1NCw4NS42MzMxNzE0IEwyOC4xNjgyODU3LDg1LjYzNzc3NjEgTDcxLjgzMTcxNDMsODUuNjM3Nzc2MSBDNzYuMTQ3MzQ5Niw4NS42Mzc3NzYxIDc5LjUwMDAyNTYsODIuNzgxMzkwMSA3OS42NTAxOTA5LDc5LjQzNzMxNjEgTDc5LjY1NTQ0MzMsNzkuMjAzMjQ3MiBMNzkuNjU1NDQzMyw0MC44ODIxNDU2IEM3OS42NTU0NDMzLDM3LjUyMzAzMTggNzYuNDEyNjY3NywzNC41OTM2OTc1IDcyLjE2MDE1NjcsMzQuNDUyODg2NiBMNzEuODYxODU5NywzNC40NDc2MTY2IEw2MS44MzkwMzU0LDM0LjQ0NzYxNjYgQzU5Ljg4OTI3MzcsMzQuNDQ3NjE2NiA1OC4zMDg2Nzk2LDMyLjg2NzAyMjUgNTguMzA4Njc5NiwzMC45MTcyNjA4IEM1OC4zMDg2Nzk2LDI5LjAzNzEzMzQgNTkuNzc4MzkwMiwyNy41MDAyNzU0IDYxLjYzMTYwMDIsMjcuMzkyODk4IEw2MS44MzkwMzU0LDI3LjM4NjkwNSBMNzEuODY5OTMxNCwyNy4zODY5MDUgQzc5Ljg1Njc5NjIsMjcuNDA1MTc1MiA4Ni41MTE3MDM4LDMzLjE1Mzk2NTcgODYuNzExNTM0MSw0MC41NDAwOTk0IEw4Ni43MTYxNTQ5LDQwLjg4MjE0NTYgTDg2LjcxNjE1NDksNzkuMjAzMjQ3MiBDODYuNzE2MTU0OSw4Ni42NTE4MTg2IDgwLjE2MDM1OTcsOTIuNTE4MzUzNSA3Mi4yMDAwODk5LDkyLjY5NDQxNzMgTDcxLjgzMTcxNDMsOTIuNjk4NDg3OCBMMjguMTY4Mjg1Nyw5Mi42OTg0ODc4IEMyMC4xNjYwMjA1LDkyLjY5ODQ4NzggMTMuNDg4OTc4OCw4Ni45NDQ4MTAxIDEzLjI4ODQ4MTMsNzkuNTQ1ODg5MSBMMTMuMjgzODQ1MSw3OS4yMDMyNDcyIEwxMy4yODM4NDUxLDQwLjg4MjE0NTYgQzEzLjI4Mzg0NTEsMzMuNDMzNTc0MSAxOS44Mzk2NDAzLDI3LjU2NzAzOTMgMjcuNzk5OTEwMSwyNy4zOTA5NzU0IEwyOC4xNjgyODU3LDI3LjM4NjkwNSBMMzguMTYwOTY0NiwyNy4zODY5MDUgWlwiIGlkPVwiUGF0aFwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBmaWxsLXJ1bGU9XCJub256ZXJvXCI+PC9wYXRoPjxsaW5lIHgxPVwiNTAuMTExNDUzNlwiIHkxPVwiNTNcIiB4Mj1cIjUwLjExMTQ1MzZcIiB5Mj1cIjEwLjQwODExODFcIiBpZD1cIkxpbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCI2XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiPjwvbGluZT48bGluZSB4MT1cIjQwLjM5OTUzNjdcIiB5MT1cIjIwLjEyMDAzNVwiIHgyPVwiNTAuMTExNDUzNlwiIHkyPVwiMTAuNDA4MTE4MVwiIGlkPVwiTGluZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjZcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCI+PC9saW5lPjxsaW5lIHgxPVwiNTAuMjIyOTA3M1wiIHkxPVwiMjAuMTIwMDM1XCIgeDI9XCI1OS45MzQ4MjQyXCIgeTI9XCIxMC40MDgxMTgxXCIgaWQ9XCJMaW5lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiNlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoNTQuOTY3NDEyLCAxNS4zNzU1MzApIHNjYWxlKC0xLCAxKSB0cmFuc2xhdGUoLTU0Ljk2NzQxMiwgLTE1LjM3NTUzMCkgXCI+PC9saW5lPicpXHJcblxyXG4gICAgYWRkSWNvbignc2hhcmUtbWFjc3RvcmllcycsICc8cGF0aCBkPVwiTTM4LjE2MDk2NDYsMjcuMzg2OTA1IEM0MC4xMTA3MjYzLDI3LjM4NjkwNSA0MS42OTEzMjA0LDI4Ljk2NzQ5OTEgNDEuNjkxMzIwNCwzMC45MTcyNjA4IEM0MS42OTEzMjA0LDMyLjc5NzM4ODEgNDAuMjIxNjA5OCwzNC4zMzQyNDYyIDM4LjM2ODM5OTgsMzQuNDQxNjIzNiBMMzguMTYwOTY0NiwzNC40NDc2MTY2IEwyOC4xNjgyODU3LDM0LjQ0NzYxNjYgQzIzLjg1MjY1MDQsMzQuNDQ3NjE2NiAyMC40OTk5NzQ0LDM3LjMwNDAwMjYgMjAuMzQ5ODA5MSw0MC42NDgwNzY2IEwyMC4zNDQ1NTY3LDQwLjg4MjE0NTYgTDIwLjM0NDU1NjcsNzkuMjAzMjQ3MiBDMjAuMzQ0NTU2Nyw4Mi41Njg3MjMyIDIzLjU5OTE1MDIsODUuNTAxNTk3MyAyNy44Njg3ODU0LDg1LjYzMzE3MTQgTDI4LjE2ODI4NTcsODUuNjM3Nzc2MSBMNzEuODMxNzE0Myw4NS42Mzc3NzYxIEM3Ni4xNDczNDk2LDg1LjYzNzc3NjEgNzkuNTAwMDI1Niw4Mi43ODEzOTAxIDc5LjY1MDE5MDksNzkuNDM3MzE2MSBMNzkuNjU1NDQzMyw3OS4yMDMyNDcyIEw3OS42NTU0NDMzLDQwLjg4MjE0NTYgQzc5LjY1NTQ0MzMsMzcuNTIzMDMxOCA3Ni40MTI2Njc3LDM0LjU5MzY5NzUgNzIuMTYwMTU2NywzNC40NTI4ODY2IEw3MS44NjE4NTk3LDM0LjQ0NzYxNjYgTDYxLjgzOTAzNTQsMzQuNDQ3NjE2NiBDNTkuODg5MjczNywzNC40NDc2MTY2IDU4LjMwODY3OTYsMzIuODY3MDIyNSA1OC4zMDg2Nzk2LDMwLjkxNzI2MDggQzU4LjMwODY3OTYsMjkuMDM3MTMzNCA1OS43NzgzOTAyLDI3LjUwMDI3NTQgNjEuNjMxNjAwMiwyNy4zOTI4OTggTDYxLjgzOTAzNTQsMjcuMzg2OTA1IEw3MS44Njk5MzE0LDI3LjM4NjkwNSBDNzkuODU2Nzk2MiwyNy40MDUxNzUyIDg2LjUxMTcwMzgsMzMuMTUzOTY1NyA4Ni43MTE1MzQxLDQwLjU0MDA5OTQgTDg2LjcxNjE1NDksNDAuODgyMTQ1NiBMODYuNzE2MTU0OSw3OS4yMDMyNDcyIEM4Ni43MTYxNTQ5LDg2LjY1MTgxODYgODAuMTYwMzU5Nyw5Mi41MTgzNTM1IDcyLjIwMDA4OTksOTIuNjk0NDE3MyBMNzEuODMxNzE0Myw5Mi42OTg0ODc4IEwyOC4xNjgyODU3LDkyLjY5ODQ4NzggQzIwLjE2NjAyMDUsOTIuNjk4NDg3OCAxMy40ODg5Nzg4LDg2Ljk0NDgxMDEgMTMuMjg4NDgxMyw3OS41NDU4ODkxIEwxMy4yODM4NDUxLDc5LjIwMzI0NzIgTDEzLjI4Mzg0NTEsNDAuODgyMTQ1NiBDMTMuMjgzODQ1MSwzMy40MzM1NzQxIDE5LjgzOTY0MDMsMjcuNTY3MDM5MyAyNy43OTk5MTAxLDI3LjM5MDk3NTQgTDI4LjE2ODI4NTcsMjcuMzg2OTA1IEwzOC4xNjA5NjQ2LDI3LjM4NjkwNSBaXCIgaWQ9XCJQYXRoXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiIGZpbGwtcnVsZT1cIm5vbnplcm9cIj48L3BhdGg+PGxpbmUgeDE9XCI1MC4xMTE0NTM2XCIgeTE9XCIzMi40ODkzODE1XCIgeDI9XCI1MC4xMTE0NTM2XCIgeTI9XCIxMC40MDgxMTgxXCIgaWQ9XCJMaW5lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiNlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIj48L2xpbmU+PHBhdGggZD1cIk02Mi4yMzg1NjY5LDM4Ljg2MDU2MTQgTDM3Ljc2MTQzMzEsMzguODYwNTYxNCBDMzYuNDYxNTkyLDM4Ljg2MDU2MTQgMzUuNDA3ODYyNiwzOS45MTQyOTA4IDM1LjQwNzg2MjYsNDEuMjE0MTMxOSBMMzUuNDA3ODYyNiw3OC44NzEyNjA4IEwzNS40MTQyMTc0LDc5LjA1MDYxMTUgQzM1LjU0ODg1MjMsODAuOTM1OTk1IDM3Ljc5MjgxODcsODEuOTIxMzc0IDM5LjI3NzE4NDYsODAuNjcxNzU4NCBMNDkuOTk4ODIzMiw3MS42NDQ1NTc5IEw2MC43MjI4MTU0LDgwLjY3MTc1ODQgQzYyLjI1MzU2NzgsODEuOTYwNDI0NCA2NC41OTIxMzc0LDgwLjg3MjIyNjIgNjQuNTkyMTM3NCw3OC44NzEyNjA4IEw2NC41OTIxMzc0LDQxLjIxNDEzMTkgQzY0LjU5MjEzNzQsMzkuOTE0MjkwOCA2My41Mzg0MDgsMzguODYwNTYxNCA2Mi4yMzg1NjY5LDM4Ljg2MDU2MTQgWiBNNTkuODg0OTk2Myw0My41Njc2MzggTDU5Ljg4NDk5NjMsNzMuODEzMzczMiBMNTEuNTE1NzUxNSw2Ni43Njc3MDg2IEw1MS4zNTcxNDQzLDY2LjY0NTIyODggQzUwLjQ5MDY0NjcsNjYuMDMyODI5NyA0OS4zMDg2ODQxLDY2LjA3MzY1NjMgNDguNDg0MjQ4NSw2Ni43Njc3MDg2IEw0MC4xMTUwMDM3LDczLjgxMjE5NjQgTDQwLjExNTAwMzcsNDMuNTY3NjM4IEw1OS44ODQ5OTYzLDQzLjU2NzYzOCBaXCIgaWQ9XCJSZWN0YW5nbGVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIgZmlsbC1ydWxlPVwibm9uemVyb1wiPjwvcGF0aD48bGluZSB4MT1cIjQwLjM5OTUzNjdcIiB5MT1cIjIwLjEyMDAzNVwiIHgyPVwiNTAuMTExNDUzNlwiIHkyPVwiMTAuNDA4MTE4MVwiIGlkPVwiTGluZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjZcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCI+PC9saW5lPjxsaW5lIHgxPVwiNTAuMjIyOTA3M1wiIHkxPVwiMjAuMTIwMDM1XCIgeDI9XCI1OS45MzQ4MjQyXCIgeTI9XCIxMC40MDgxMTgxXCIgaWQ9XCJMaW5lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiNlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoNTQuOTY3NDEyLCAxNS4zNzU1MzApIHNjYWxlKC0xLCAxKSB0cmFuc2xhdGUoLTU0Ljk2NzQxMiwgLTE1LjM3NTUzMCkgXCI+PC9saW5lPicpXHJcblxyXG4gICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBFeHBvcnRQbHVnaW5TZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSlcclxuXHJcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogJ2V4cG9ydC1tYXJrZG93bi13aXRoLWVtYmVkcycsXHJcblx0XHRcdG5hbWU6ICdFeHBvcnQgTWFya2Rvd24gd2l0aCBFbWJlZHMnLFxyXG4gICAgICBpY29uOiAnc2hhcmUtZXhwb3J0JyxcclxuXHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcclxuXHRcdFx0XHRjb25zdCBmaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKVxyXG5cdFx0XHRcdGlmIChmaWxlICE9PSBudWxsKSB7XHJcblx0XHRcdFx0XHRuZXcgU2V0dGluZ3NNb2RhbCh0aGlzKS5vcGVuKClcclxuXHRcdFx0XHRcdHJldHVybiB0cnVlXHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiBmYWxzZVxyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG4gICAgaWYgKHRoaXMuYXBwLmlzTW9iaWxlKSB7XHJcbiAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgICAgaWQ6ICdzaGFyZS1tYXJrZG93bi13aXRoLWVtYmVkcycsXHJcbiAgICAgICAgbmFtZTogJ1NoYXJlIE1hcmtkb3duIHdpdGggRW1iZWRzJyxcclxuICAgICAgICBpY29uOiAnc2hhcmUtZXhwb3J0JyxcclxuICAgICAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKClcclxuICAgICAgICAgIGlmIChmaWxlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVtYmVkRmxhdHRlbmVyID0gbmV3IEVtYmVkRmxhdHRlbmVyKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAsIFxyXG4gICAgICAgICAgICAgICAgdHJ1ZSwgXHJcbiAgICAgICAgICAgICAgICB0cnVlLFxyXG4gICAgICAgICAgICAgICAgdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgJycsXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLnBhZ2VTZXBhcmF0b3IsXHJcbiAgICAgICAgICAgICAgICAwXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgICAgY29uc3QgZmxhdHRlbmVkID0gYXdhaXQgZW1iZWRGbGF0dGVuZXIuZmxhdHRlbihmaWxlKVxyXG4gICAgICAgICAgICBjb25zdCBmbGF0dGVuZWRMaW5rZWQgPSBlbWJlZEZsYXR0ZW5lci5yZXBsYWNlTGlua3MoZmxhdHRlbmVkKVxyXG4gICAgICAgICAgICBjb25zdCBmbGF0dGVuZWRMaW5rZWRFeHRyYWN0ZWQgPSBlbWJlZEZsYXR0ZW5lci5leHRyYWN0Q29tcGxhaW50cyhmbGF0dGVuZWRMaW5rZWQsIHRoaXMuc2V0dGluZ3MuY29tcGxhaW50RGVsaW1pdGVyKVxyXG5cclxuICAgICAgICAgICAgY29uc3Qgc2hhcmUgPSB7XHJcbiAgICAgICAgICAgICAgdGV4dDogZmxhdHRlbmVkTGlua2VkRXh0cmFjdGVkLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG5hdmlnYXRvci5zaGFyZShzaGFyZSlcclxuICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICAgdGhpcy5hZGRDb21tYW5kKHtcclxuICAgICAgICBpZDogJ3NoYXJlLW1hcmtkb3duLXdpdGgtZW1iZWRzLWJhc2VVUkwnLFxyXG4gICAgICAgIG5hbWU6ICdTaGFyZSBNYXJrZG93biB3aXRoIEVtYmVkcyB3aXRoIGJhc2VVUkwnLFxyXG4gICAgICAgIGljb246ICdzaGFyZS1tYWNzdG9yaWVzJyxcclxuICAgICAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKClcclxuICAgICAgICAgIGlmIChmaWxlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1ldGFkYXRhID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSlcclxuICAgICAgICAgICAgaWYgKG1ldGFkYXRhLmZyb250bWF0dGVyPy5bJ2Jhc2VVUkwnXSkge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGVtYmVkRmxhdHRlbmVyID0gbmV3IEVtYmVkRmxhdHRlbmVyKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAsIFxyXG4gICAgICAgICAgICAgICAgdHJ1ZSwgXHJcbiAgICAgICAgICAgICAgICB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZmFsc2UsXHJcbiAgICAgICAgICAgICAgICB0cnVlLFxyXG4gICAgICAgICAgICAgICAgbWV0YWRhdGEuZnJvbnRtYXR0ZXJbJ2Jhc2VVUkwnXSxcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MucGFnZVNlcGFyYXRvcixcclxuICAgICAgICAgICAgICAgIHBhcnNlSW50KHRoaXMuc2V0dGluZ3MuaGVhZGluZ0xldmVsWzFdKVxyXG4gICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICBjb25zdCBmbGF0dGVuZWQgPSBhd2FpdCBlbWJlZEZsYXR0ZW5lci5mbGF0dGVuKGZpbGUpXHJcbiAgICAgICAgICAgICAgY29uc3QgZmxhdHRlbmVkTGlua2VkID0gZW1iZWRGbGF0dGVuZXIucmVwbGFjZUxpbmtzKGZsYXR0ZW5lZClcclxuICAgICAgICAgICAgICBjb25zdCBmbGF0dGVuZWRMaW5rZWRFeHRyYWN0ZWQgPSBlbWJlZEZsYXR0ZW5lci5leHRyYWN0Q29tcGxhaW50cyhmbGF0dGVuZWRMaW5rZWQsIHRoaXMuc2V0dGluZ3MuY29tcGxhaW50RGVsaW1pdGVyKVxyXG4gICAgICAgICAgICAgIGNvbnN0IHNoYXJlID0ge1xyXG4gICAgICAgICAgICAgICAgdGV4dDogZmxhdHRlbmVkTGlua2VkRXh0cmFjdGVkLFxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBuYXZpZ2F0b3Iuc2hhcmUoc2hhcmUpXHJcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBuZXcgTm90aWNlKCdObyBiYXNlVVJMIHNwZWNpZmllZC4nKVxyXG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblx0fVxyXG5cclxuICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKVxyXG5cdH1cclxuXHJcblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xyXG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKVxyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgRXhwb3J0UGx1Z2luU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG5cdHBsdWdpbjogRXhwb3J0UGx1Z2luXHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEV4cG9ydFBsdWdpbikge1xyXG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pXHJcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG5cdH1cclxuXHJcblx0ZGlzcGxheSgpOiB2b2lkIHtcclxuXHRcdGxldCB7Y29udGFpbmVyRWx9ID0gdGhpc1xyXG5cclxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KClcclxuXHJcblx0XHRjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7dGV4dDogJ1NldHRpbmdzIGZvciB0aGUgRXhwb3J0IE1hcmtkb3duIHdpdGggRW1iZWRzIHBsdWdpbi4nfSlcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoJ1BhZ2Ugc2VwYXJhdG9yJylcclxuXHRcdFx0LnNldERlc2MoJ1RoZSB0ZXh0IHRvIGluc2VydCBiZXR3ZWVuIHBhZ2VzIHdoZW4gZXhwb3J0aW5nIHdpdGggYmFzZVVSTC4nKVxyXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ2UueC4gPCEtLW5leHRwYWdlLS0+JylcclxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucGFnZVNlcGFyYXRvcilcclxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYWdlU2VwYXJhdG9yID0gdmFsdWVcclxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpXHJcblx0XHRcdFx0fSkpXHJcbiAgICBcclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnTmV3IHBhZ2UgaGVhZGluZyBsZXZlbCcpXHJcbiAgICAgIC5zZXREZXNjKCdUaGUgaGVhZGluZyBsZXZlbCB0aGF0IG1hcmtzIHRoZSBzdGFydCBvZiBhIG5ldyBwYWdlLicpXHJcbiAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxyXG4gICAgICAgIC5hZGRPcHRpb24oJ0gxJywgJ0gxJylcclxuICAgICAgICAuYWRkT3B0aW9uKCdIMicsICdIMicpXHJcbiAgICAgICAgLmFkZE9wdGlvbignSDMnLCAnSDMnKVxyXG4gICAgICAgIC5hZGRPcHRpb24oJ0g0JywgJ0g0JylcclxuICAgICAgICAuYWRkT3B0aW9uKCdINScsICdINScpXHJcbiAgICAgICAgLmFkZE9wdGlvbignSDYnLCAnSDYnKVxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5oZWFkaW5nTGV2ZWwpXHJcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGVhZGluZ0xldmVsID0gdmFsdWVcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpXHJcbiAgICAgICAgfSkpXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAuc2V0TmFtZSgnSGlnaGxpZ2h0IGRlbGltaXRlcicpXHJcbiAgICAuc2V0RGVzYygnU2VudGVuY2VzIHN1cnJvdW5kZWQgYnkgdGhlIGhpZ2hsaWdodCBkZWxpbWl0ZXIgd2lsbCBiZSBjb3BpZWQgdG8gYSBsaXN0IGF0IHRoZSBib3R0b20gb2YgdGhlIGNvbXBpbGVkIGRvY3VtZW50LCBhbmQgdGhlIGRlbGltaXRlcnMgd2lsbCBiZSByZW1vdmVkLicpXHJcbiAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgLnNldFBsYWNlaG9sZGVyKCdlLnguIDo6OicpXHJcbiAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb21wbGFpbnREZWxpbWl0ZXIpXHJcbiAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb21wbGFpbnREZWxpbWl0ZXIgPSB2YWx1ZVxyXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpXHJcbiAgICAgIH0pKVxyXG5cdH1cclxufSJdLCJuYW1lcyI6WyJnZXRMaW5rcGF0aCIsIk5vdGljZSIsIk1vZGFsIiwiU2V0dGluZyIsIlBsdWdpbiIsImFkZEljb24iLCJQbHVnaW5TZXR0aW5nVGFiIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdURBO0FBQ08sU0FBUyxTQUFTLENBQUMsT0FBTyxFQUFFLFVBQVUsRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFFO0FBQzdELElBQUksU0FBUyxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsT0FBTyxLQUFLLFlBQVksQ0FBQyxHQUFHLEtBQUssR0FBRyxJQUFJLENBQUMsQ0FBQyxVQUFVLE9BQU8sRUFBRSxFQUFFLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFO0FBQ2hILElBQUksT0FBTyxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsT0FBTyxDQUFDLEVBQUUsVUFBVSxPQUFPLEVBQUUsTUFBTSxFQUFFO0FBQy9ELFFBQVEsU0FBUyxTQUFTLENBQUMsS0FBSyxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRTtBQUNuRyxRQUFRLFNBQVMsUUFBUSxDQUFDLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsU0FB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
